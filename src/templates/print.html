<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Print Record - {{ record.patient_ur }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <style>
        
        body {
            font-size: 11pt;
            font-family: Arial, sans-serif;
            padding: 15px;
            color: #000;
            line-height: 1.5;
            background-color: #eee; 
        }

        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 800px; 
            margin: 20px auto;
        }

        .field-label {
            font-weight: bold;
            padding-right: 0.3em;
            white-space: nowrap; 
        }

        .value-box {
            border: 1px solid #555;
            padding: 2px 5px;
            min-height: 25px;
            display: inline-block;
            min-width: 60px; 
            margin-left: 5px;
            background-color: #f8f9fa;
            vertical-align: baseline;
            line-height: 1.4;
            font-family: monospace;
        }

        .value-box-small { min-width: 50px; }
        .value-box-large { min-width: 100px; }
        .value-box-xlarge { min-width: 150px; }


        .checkbox-symbol {
            font-family: monospace;
            font-size: 1.1em; 
            vertical-align: middle;
            display: inline-block;
            width: 1.1em; 
            text-align: center;
            border: 1px solid #ccc;
            line-height: 1;
            margin: 0 2px;
            background-color: #f8f9fa;
        }

        .row>div {
            margin-bottom: 0.3rem; 
        }

        fieldset {
            border: 1px solid #adb5bd;
            border-radius: 4px;
            padding: 10px 15px;
            margin-bottom: 15px;
            background-color: #fff;
        }

        legend {
            font-weight: 600;
            font-size: 1.1em;
            color: #000;
            padding: 0 8px;
            margin-left: 5px;
            background-color: #fff;
            width: auto;
            display: block; 
            float: none; 
            margin-bottom: 0.5rem; 
        }
        fieldset > *:last-child { margin-bottom: 0 !important; } 


        /* --- Print Styles --- */
        @media print {
            @page {
                size: A4;
                margin: 10mm 8mm; 
            }

            body {
                font-size: 8pt; 
                line-height: 1.15; 
                background-color: #fff !important; 
                padding: 0;
                margin: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .no-print, .btn, .navbar, .alert { display: none !important; }

            .container {
                max-width: 100% !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                border: none !important;
                box-shadow: none !important;
            }

            h3, h4 {
                text-align: center !important;
                margin-bottom: 0.3rem !important; 
                font-weight: bold;
            }
            h3 { font-size: 12pt; }
            h4 { font-size: 10pt; }

            fieldset {
                border: 1px solid #666 !important;
                padding: 1.5mm 3mm !important; 
                margin-bottom: 2mm !important; 
                page-break-inside: avoid !important;
                border-radius: 0 !important;
                box-shadow: none !important;
                background-color: #fff !important;
                position: relative;
            }

            legend {
                font-weight: bold !important;
                font-size: 9pt !important;
                padding: 0 5px !important; 
                margin-left: 3mm !important;
                display: block !important; 
                margin-bottom: 1mm !important;
                line-height: 1.1 !important;
            }


            .value-box {
                background-color: transparent !important; 
                padding: 0.5mm 1mm !important;
                min-height: auto !important;
                line-height: 1.1 !important;
                margin-left: 1mm !important;
                font-size: 8pt;
            }

            .value-box-small { min-width: 10mm !important; }
            .value-box-large { min-width: 20mm !important; }
            .value-box-xlarge { min-width: 30mm !important; }


            .checkbox-symbol {
                font-size: 9pt; 
                border: 1px solid #333 !important;
                background-color: transparent !important;
                padding: 0;
                margin: 0 0.5mm;
            }

            .row {
                margin-left: 0 !important;
                margin-right: 0 !important;
                margin-bottom: 0.1rem !important; 
            }

             .row > [class*="col-"] {
                padding: 0 1mm !important; 
                margin-bottom: 0 !important; 
                 display: flex; 
                 align-items: baseline; 
            }
            .row.align-items-center > [class*="col-"] { align-items: center; }
            .row.align-items-start > [class*="col-"] { align-items: flex-start; }


            .mb-1, .mb-2, .mb-3, .mb-4 { margin-bottom: 0.1rem !important; }
            .mt-1, .mt-2, .mt-3, .mt-4 { margin-top: 0.1rem !important; }
            .ms-1, .ms-2, .ms-3, .ms-4 { margin-left: 0.5mm !important; } 
            .me-1, .me-2, .me-3, .me-4 { margin-right: 0.5mm !important; }


            .field-label {
                padding-right: 0.5mm !important;
                margin-bottom: 0; 
                flex-shrink: 0; 
            }

            .unit {
                margin-left: 0.5mm;
                white-space: nowrap;
            }

            .table {
                margin-bottom: 0 !important;
                font-size: 7.5pt !important; 
                width: 100% !important;
                border-collapse: collapse !important; 
            }

            .table td, .table th {
                padding: 0.5mm 1mm !important; 
                vertical-align: middle !important;
                border: 1px solid #888 !important;
                line-height: 1.1;
                word-wrap: break-word; 
            }

            .table .field-label {
                font-weight: bold;
                padding-right: 1mm !important;
                white-space: normal; 
                text-align: left;
                vertical-align: top; 
            }

            .table-bordered { border: 1px solid #666 !important; }

            a[href]:after { content: none !important; }
            a { text-decoration: none !important; color: black !important; }

            .spacer { flex-grow: 1; }
        }
    </style>
</head>

<body>
    <div class="container">
        <h3 class="text-center mb-2">CONFIDENTIAL</h3>
        <h4 class="text-center mb-3">
            Relationship between invasive measurements and non-invasive Echocardiogram guided parameters of Right Atrial Pressure
             | A Prospective Observational study - HREA | 
            SAGE ID: 2024/PID00314 - 2024/SVH00230
        </h4>

        <fieldset>
            <legend>Patient Information & Setup</legend>
            <div class="row mb-1">
                <div class="col-auto field-label">Patient UR No:</div>
                <div class="col-auto"><span class="value-box value-box-large">{{ record.patient_ur | fmt }}</span></div>
                <div class="col-auto field-label ms-3">Patient's Serial Number:</div>
                <div class="col-auto"><span class="value-box value-box-large">{{ record.patient_serial | fmt }}</span></div>
                 <div class="spacer"></div> 
                <div class="col-auto field-label">Date of Collection:</div>
                <div class="col-auto"><span class="value-box value-box-large">{{ record.collection_date | fmt }}</span></div>
            </div>
            <div class="row mb-1 align-items-center">
                <div class="col-auto field-label">Observer:</div>
                <div class="col-auto"><span class="value-box value-box-xlarge">{{ record.observer | fmt }}</span></div>
                <div class="col-auto field-label ms-3">Height:</div>
                <div class="col-auto"><span class="value-box">{{ record.height_cm | fmt }}</span><span class="unit">cm</span></div>
                <div class="col-auto field-label ms-3">Weight:</div>
                <div class="col-auto"><span class="value-box">{{ record.weight_kg | fmt }}</span><span class="unit">kg</span></div>
                <div class="col-auto field-label ms-3">BSA:</div>
                <div class="col-auto"><span class="value-box">{{ record.bsa | fmt }}</span><span class="unit">m²</span></div>
                 <div class="spacer"></div> 
                <div class="col-auto field-label">Checks:</div>
                <div class="col-auto">
                    <span class="checkbox-symbol">{{ 'X' if record.check_head_of_bed else ' ' }}</span> Head of Bed 30°
                    <span class="checkbox-symbol ms-2">{{ 'X' if record.check_transducer_level else ' ' }}</span> Transducer leveled/zeroed
                </div>
            </div>
        </fieldset>

        <div class="row">
            <div class="col-6" >
                <fieldset class="h-100">
                    <legend>Current Patient Treatment</legend>
                    <div class="row mb-1">
                         <div class="col-auto">Ventilation:</div>
                        <div class="col">
                             <span class="checkbox-symbol">{{ 'X' if record.ventilation == 'spontaneous' else ' ' }}</span> Spontaneous
                             <span class="checkbox-symbol ms-2">{{ 'X' if record.ventilation == 'invasive' else ' ' }}</span> Invasive
                             <span class="checkbox-symbol ms-2">{{ 'X' if record.ventilation == 'noninvasive' else ' ' }}</span> Non-Invasive
                         </div>
                    </div>
                     <div class="row">
                        <div class="col-auto field-label">PEEP:</div>
                        <div class="col-auto"><span class="value-box value-box-small">{{ record.peep | fmt }}</span></div>
                    </div>
                </fieldset>
            </div>
            <div class="col-6" >
                <fieldset class="h-100">
                    <legend>Inotropes/Vasopressors</legend>
                     <div > 
                        <span class="checkbox-symbol">{{ 'X' if record.medication_metaraminol else ' ' }}</span> Metaraminol
                        <span class="checkbox-symbol ms-2">{{ 'X' if record.medication_noradrenaline else ' ' }}</span> Noradrenaline
                        <span class="checkbox-symbol ms-2">{{ 'X' if record.medication_adrenaline else ' ' }}</span> Adrenaline
                        <br>
                        <span class="checkbox-symbol">{{ 'X' if record.medication_gtn else ' ' }}</span> GTN
                        <span class="checkbox-symbol ms-2">{{ 'X' if record.medication_milrinone else ' ' }}</span> Milrinone
                        <span class="checkbox-symbol ms-2">{{ 'X' if record.medication_isoprenaline else ' ' }}</span> Isoprenaline
                        <br>
                        <span class="checkbox-symbol">{{ 'X' if record.medication_dobutamine else ' ' }}</span> Dobutamine
                    </div>
                </fieldset>
            </div>
        </div>

        <fieldset>
            <legend>Observations</legend>
            <div class="row mb-1">
                <div class="col-auto field-label">Cardiac Rhythm:</div>
                <div class="col-auto"><span class="value-box value-box-xlarge">{{ record.cardiac_rhythm | fmt }}</span></div>
                 <div class="col-auto field-label ms-3">CVC Location:</div>
                <div class="col-auto"><span class="value-box value-box-xlarge">{{ record.cvc_location | fmt }}</span></div>
            </div>
             <div class="row mb-1">
                 <div class="col-auto field-label">JVP height:</div>
                <div class="col-auto"><span class="value-box value-box-small">{{ record.jvp_height_cm | fmt }}</span><span class="unit">cm</span></div>
                <div class="col-auto ms-3">
                     <span class="checkbox-symbol">{{ 'X' if record.photograph_taken else ' ' }}</span> Photograph taken
                </div>
            </div>
        </fieldset>




        <fieldset>
            <legend>ECHO Measurements</legend>
             <div class="row mb-1 align-items-center">
                <div class="col-auto field-label">ECHO Start:</div>
                <div class="col-auto"><span class="value-box value-box-large">{{ record.echo_start_time | fmt }}</span></div>
                <div class="col-auto field-label ms-2">Completion:</div>
                <div class="col-auto"><span class="value-box value-box-large">{{ record.echo_completion_time | fmt }}</span></div>
                <div class="col-auto field-label ms-2">Total (min):</div>
                <div class="col-auto"><span class="value-box value-box-small">{{ record.echo_total_time_min | fmt }}</span></div>
            </div>
            <hr > 
            <table class="table table-bordered table-sm" >
                <tbody>
                    <tr>
                        <td class="field-label" style="width:30%">IVC diameter (cm)</td>
                        <td style="width:20%">{{ record.ivc_diameter_cm | fmt }}</td>
                        <td class="field-label" style="width:30%">E velocity (m/s)</td>
                        <td style="width:20%">{{ record.e_velocity_mps | fmt }}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Systemic venous flow vel (cm/s)</td>
                        <td>{{ record.systemic_venous_flow_velocity_cmps | fmt }}</td>
                        <td class="field-label">A velocity (m/s)</td>
                        <td>{{ record.a_velocity_mps | fmt }}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Tricuspid valve Doppler inflow (cm/s)</td>
                        <td>{{ record.tricuspid_valve_doppler_inflow_cmps | fmt }}</td>
                        <td class="field-label">Mean Gradient (mmHg)</td>
                        <td>{{ record.mean_gradient_mmhg | fmt }}</td>
                    </tr>
                    <tr>
                         <td class="field-label">TR Max (m/s)</td>
                        <td>{{ record.tr_max_mps | fmt }}</td>
                        <td class="field-label">DT (m/s)</td>
                        <td>{{ record.dt_mps | fmt }}</td>
                    </tr>
                    <tr>
                         <td class="field-label">TR peak gradient (mmHg)</td>
                        <td>{{ record.tr_peak_gradient_mmhg | fmt }}</td>
                        <td class="field-label">PHT (m/s)</td>
                        <td>{{ record.pht_mps | fmt }}</td>
                    </tr>
                    <tr>
                         <td class="field-label">RAP (mmHg)</td>
                        <td>{{ record.rap_mmhg | fmt }}</td>
                         <td class="field-label">TVA (cont) (cm²)</td>
                        <td>{{ record.tva_cont_cm2 | fmt }}</td>
                    </tr>
                    <tr>
                        <td class="field-label">RVSP (mmHg)</td>
                        <td>{{ record.rvsp_mmhg | fmt }}</td>
                        <td class="field-label">RSV'</td> 
                        <td>{{ record.rsv_prime | fmt }}</td>
                    </tr>
                     <tr>
                         <td class="field-label">VTI (cm)</td>
                        <td>{{ record.vti_cm | fmt }}</td>
                        <td class="field-label">TEV'</td> 
                        <td>{{ record.tev_prime | fmt }}</td>
                    </tr>
                </tbody>
            </table>
        </fieldset>

        <fieldset>
        <legend>Haemodynamics</legend>
        <div class="row mb-1">
            <div class="col-auto field-label">HR:</div>
            <div class="col-auto"><span class="value-box value-box-small">{{ record.hr | fmt }}</span></div>
            <div class="col-auto field-label ms-2">Sys BP:</div>
            <div class="col-auto"><span class="value-box value-box-small">{{ record.sys_bp_mmhg | fmt }}</span><span class="unit">mmHg</span></div>
            <div class="col-auto field-label ms-2">Dia BP:</div>
            <div class="col-auto"><span class="value-box value-box-small">{{ record.dia_bp_mmhg | fmt }}</span><span class="unit">mmHg</span></div>
            <div class="col-auto field-label ms-2">Map BP:</div>
            <div class="col-auto"><span class="value-box value-box-small">{{ record.map_bp_mmhg | fmt }}</span><span class="unit">mmHg</span></div>
        </div>
        <div class="row">
            <div class="col-auto field-label">CVP:</div>
            <div class="col-auto"><span class="value-box value-box-small">{{ record.cvp_mmhg | fmt }}</span><span class="unit">mmHg</span></div>
            <div class="col-auto field-label ms-2">Pulse Pressure Var:</div>
            <div class="col-auto"><span class="value-box value-box-small">{{ record.pulse_pressure_variation_mmhg | fmt }}</span><span class="unit">mmHg</span></div>
        </div>
    </fieldset>


        
    </div>
    <div class="text-center mt-4 no-print">
        <button onclick="window.print()" class="btn btn-primary">Print</button>
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Close</a>
    </div>
</body>
</html>